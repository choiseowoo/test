한 줄에 모든 레코드 값이 하나의 필드로 합쳐져 `Split` 결과에서 `fields(8)` 값을 제대로 불러올 수 없을 때가 있습니다. 주된 이유는 **CSV 파일의 구조**나 **인코딩 방식** 때문일 가능성이 큽니다. 일반적인 원인과 해결 방안을 확인해보겠습니다.

1. **CSV 파일의 인코딩 차이**  
   `CWAT` 파일이 `UTF-8` (BOM 없음) 인코딩 방식이고 `Tanium` 파일이 `UTF-16` (BOM 있음)이라면, VBS에서 `OpenTextFile` 메서드로 파일을 열 때 인코딩이 제대로 해석되지 않을 수 있습니다. 특히 `UTF-16` 인코딩을 사용할 경우 줄 전체가 하나의 문자열로 처리될 가능성이 있습니다.

2. **쉼표로 나누지 못하는 경우**  
   `Split(line, ",")`로 쉼표를 기준으로 나누지 못하면 `fields(0)`에 한 줄 전체가 들어가고, 이후 인덱스 (`fields(8)` 등) 접근이 불가능해집니다.

### 해결 방법: 파일 인코딩 변환 및 확인

우선, `Tanium` 파일의 인코딩을 `UTF-8` (BOM 없음)으로 저장해 두 파일의 인코딩을 동일하게 한 후 다시 시도해 보시기 바랍니다. 이렇게 하면 `Split` 함수가 예상대로 작동할 가능성이 높아집니다.

또한 코드에서 각 줄이 정상적으로 분리되었는지 확인하는 추가 로깅을 넣어볼 수도 있습니다:

```vbscript
' fields 배열 길이 출력 (디버깅용)
WScript.Echo "Fields count: " & UBound(fields)
```

위와 같이 `WScript.Echo`를 사용하여 각 줄의 `fields` 배열 길이를 확인해보면, `Split` 결과가 제대로 이루어졌는지 알 수 있습니다.
