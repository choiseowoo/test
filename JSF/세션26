### **ğŸ“Œ ë¬¸ì œ ë¶„ì„**  
í˜„ì¬ `MsSession msSession = (MsSession) session.getAttribute(SESSIONKEY_SESSION);` ì½”ë“œì—ì„œ  
`ClassCastException`ì´ ë°œìƒí•˜ëŠ” ì´ìœ ëŠ” **ì„¸ì…˜ì— ì €ì¥ëœ ë°ì´í„° íƒ€ì…ì´ `MsSession`ì´ ì•„ë‹ˆë¼ ë‹¤ë¥¸ íƒ€ì…(String, Map ë“±)ì´ê¸° ë•Œë¬¸**ì…ë‹ˆë‹¤.  

---

### **ğŸ“Œ í•´ê²° ë°©ë²•**  
1. **ì„¸ì…˜ì— ì €ì¥ëœ ê°ì²´ê°€ `MsSession`ì¸ì§€ í™•ì¸í•˜ê³  ë³€í™˜ ì²˜ë¦¬**
2. **ì˜ëª»ëœ íƒ€ì…ì´ ë“¤ì–´ì™”ì„ ê²½ìš° ì•ˆì „í•˜ê²Œ ì²˜ë¦¬**

---

### **âœ… ë°©ë²• 1) `instanceof` ê²€ì‚¬í•˜ì—¬ ì•ˆì „í•˜ê²Œ ë³€í™˜**  
```java
public static MsSession getMsSession() {
    if (FacesContext.getCurrentInstance() == null) {
        return null;
    }
    ExternalContext extContext = FacesContext.getCurrentInstance().getExternalContext();
    if (extContext == null) {
        return null;
    }
    HttpServletRequest servletRequest = (HttpServletRequest) extContext.getRequest();
    if (servletRequest == null) {
        return null;
    }
    HttpSession session = servletRequest.getSession();
    if (session == null) {
        return null;
    }

    // ì„¸ì…˜ì—ì„œ ê°ì²´ ê°€ì ¸ì˜¤ê¸°
    Object sessionObj = session.getAttribute(SESSIONKEY_SESSION);

    // ì˜¬ë°”ë¥¸ íƒ€ì…ì¸ì§€ ê²€ì‚¬
    if (sessionObj instanceof MsSession) {
        return (MsSession) sessionObj;
    } else {
        System.out.println("âš ï¸ ì„¸ì…˜ ë°ì´í„° íƒ€ì… ë¶ˆì¼ì¹˜: " + sessionObj);
        return null;  // í˜¹ì€ ìƒˆë¡œìš´ MsSession ê°ì²´ ìƒì„± ê°€ëŠ¥
    }
}
```
ğŸ’¡ **`instanceof`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„¸ì…˜ì— ì €ì¥ëœ ë°ì´í„°ê°€ `MsSession` íƒ€ì…ì¸ì§€ í™•ì¸**í•˜ê³ ,  
ì•„ë‹ˆë¼ë©´ `null`ì„ ë°˜í™˜í•˜ê±°ë‚˜ ìƒˆë¡œìš´ `MsSession` ê°ì²´ë¥¼ ìƒì„±í•˜ë©´ **ì—ëŸ¬ ë°©ì§€ ê°€ëŠ¥**.

---

### **âœ… ë°©ë²• 2) `Map`ì„ ì‚¬ìš©í•˜ì—¬ `MsSession` ê°ì²´ ëŒ€ì‹  ì €ì¥**  
`MsSession` ê°ì²´ ëŒ€ì‹  `Map<String, Object>`ì„ ì‚¬ìš©í•˜ë©´ ë” ì•ˆì „í•©ë‹ˆë‹¤.  
```java
public static MsSession getMsSession() {
    if (FacesContext.getCurrentInstance() == null) {
        return null;
    }
    ExternalContext extContext = FacesContext.getCurrentInstance().getExternalContext();
    if (extContext == null) {
        return null;
    }
    HttpServletRequest servletRequest = (HttpServletRequest) extContext.getRequest();
    if (servletRequest == null) {
        return null;
    }
    HttpSession session = servletRequest.getSession();
    if (session == null) {
        return null;
    }

    // ì„¸ì…˜ì—ì„œ ê°ì²´ ê°€ì ¸ì˜¤ê¸°
    Object sessionObj = session.getAttribute(SESSIONKEY_SESSION);

    // ì„¸ì…˜ ë°ì´í„°ê°€ Map í˜•íƒœë¼ë©´ MsSessionìœ¼ë¡œ ë³€í™˜
    if (sessionObj instanceof Map) {
        Map<String, Object> sessionData = (Map<String, Object>) sessionObj;
        
        MsSession msSession = new MsSession();
        msSession.setUserId((String) sessionData.get("USER_ID"));
        msSession.setUserRole((String) sessionData.get("USER_ROLE"));
        msSession.setUserToken((String) sessionData.get("USER_TOKEN"));
        
        return msSession;
    } else {
        System.out.println("âš ï¸ ì„¸ì…˜ ë°ì´í„°ê°€ MsSession íƒ€ì…ì´ ì•„ë‹˜: " + sessionObj);
        return null;
    }
}
```
ğŸ’¡ **ì´ ë°©ì‹ì€ `SESSIONKEY_SESSION`ì— ì €ì¥ëœ ê°’ì´ `Map<String, Object>`ì¼ ê²½ìš°ì—ë„ ë™ì‘í•˜ë„ë¡ í•¨.**  
ê¸°ì¡´ì— `session.setAttribute(SESSIONKEY_SESSION, "userid");`ì²˜ëŸ¼ `String`ì´ ì €ì¥ë˜ì—ˆì„ ê²½ìš°ë„ ë°©ì§€ ê°€ëŠ¥.

---

### **âœ… ë°©ë²• 3) `SessionScoped`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì§ì ‘ ê´€ë¦¬**  
ë§Œì•½ JSF `@SessionScoped`ë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤ë©´, **ì„¸ì…˜ ê´€ë¦¬ í´ë˜ìŠ¤ë¥¼ ì§ì ‘ ë§Œë“¤ì–´ì„œ JSFì—ì„œ ì ‘ê·¼í•˜ëŠ” ë°©ë²•ë„ ìˆìŒ**.

#### **ğŸ“Œ `SessionBean.java` (ì„¸ì…˜ ê´€ë¦¬ í´ë˜ìŠ¤)**
```java
import jakarta.enterprise.context.SessionScoped;
import jakarta.inject.Named;
import java.io.Serializable;

@Named
@SessionScoped
public class SessionBean implements Serializable {
    private String userId;
    private String userRole;
    private String userToken;

    // Getter & Setter
    public String getUserId() { return userId; }
    public void setUserId(String userId) { this.userId = userId; }

    public String getUserRole() { return userRole; }
    public void setUserRole(String userRole) { this.userRole = userRole; }

    public String getUserToken() { return userToken; }
    public void setUserToken(String userToken) { this.userToken = userToken; }
}
```
#### **ğŸ“Œ `index.xhtml`**
```xml
<h:outputText value="User Token: #{sessionBean.userToken}" />
<h:outputText value="User ID: #{sessionBean.userId}" />
<h:outputText value="User Role: #{sessionBean.userRole}" />
```
ì´ë ‡ê²Œ í•˜ë©´ **JSFì—ì„œ ìë™ìœ¼ë¡œ ì„¸ì…˜ ë°ì´í„°ë¥¼ ê´€ë¦¬**í•˜ë¯€ë¡œ `ClassCastException` ë°œìƒ ê°€ëŠ¥ì„±ì´ ì¤„ì–´ë“¦.

---

### **ğŸ“Œ ê²°ë¡ **
âœ… `instanceof`ë¥¼ ì‚¬ìš©í•˜ì—¬ **ì„¸ì…˜ì— ì €ì¥ëœ ê°ì²´ê°€ `MsSession`ì¸ì§€ í™•ì¸**  
âœ… `Map<String, Object>`ì„ ì‚¬ìš©í•˜ì—¬ **ìºìŠ¤íŒ… ì—ëŸ¬ ë°©ì§€**  
âœ… `@SessionScoped`ë¥¼ ì‚¬ìš©í•˜ì—¬ **JSFì—ì„œ ì§ì ‘ ê´€ë¦¬ ê°€ëŠ¥**  

ì´ì œ **ClassCastException ì—†ì´ ì„¸ì…˜ì„ ì•ˆì •ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆì„ ê±°ì•¼!**
