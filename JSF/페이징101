ê²€ìƒ‰ í˜ì´ì§€ì—ì„œ í˜ì´ì§• ì²˜ë¦¬í•˜ëŠ” ì „ì²´ ì˜ˆì œë¥¼ **SQL, DAO, Service, Bean(JSF Managed Bean), DTO**ë¥¼ í¬í•¨í•˜ì—¬ ë§Œë“¤ì–´ë³¼ê²Œ.  

---

# **ğŸ“Œ ì „ì²´ ì˜ˆì œ ì½”ë“œ**  
- **DB í…Œì´ë¸”:** `users (id, name, email, created_at)`
- **í˜ì´ì§• ë°©ì‹:** `LIMIT, OFFSET`ì„ ì‚¬ìš©í•œ í˜ì´ì§•  
- **íŒ¨í„´:** `ë§¨ì•ì´ë™(1), ì•ì´ë™(2), ë’¤ì´ë™(3), ë§¨ë’¤ì´ë™(4), ì¬ì„¤ì •(6)`

---

## **1ï¸âƒ£ SQL (MyBatis XML ê¸°ë°˜ ì˜ˆì œ)**  

```xml
<select id="searchUsers" resultType="UserDto">
    SELECT id, name, email, created_at 
    FROM users 
    ORDER BY created_at DESC
    LIMIT #{pageSize} OFFSET #{offset}
</select>

<select id="countTotalUsers" resultType="int">
    SELECT COUNT(*) FROM users
</select>
```
ğŸ”¹ `LIMIT #{pageSize}` â†’ í•œ ë²ˆì— ê°€ì ¸ì˜¬ ê°œìˆ˜  
ğŸ”¹ `OFFSET #{offset}` â†’ ì‹œì‘ ìœ„ì¹˜  

---

## **2ï¸âƒ£ DTO (PageControlDto.java)**
```java
@Data
public class PageControlDto {
    private int currentPage;  // í˜„ì¬ í˜ì´ì§€
    private int pageSize;     // í˜ì´ì§€ í¬ê¸°
    private int totalRecords; // ì „ì²´ ë°ì´í„° ê°œìˆ˜
    private int totalPages;   // ì „ì²´ í˜ì´ì§€ ê°œìˆ˜

    private boolean firstPageFlag; // ì²« í˜ì´ì§€ ì—¬ë¶€
    private boolean lastPageFlag;  // ë§ˆì§€ë§‰ í˜ì´ì§€ ì—¬ë¶€
}
```

---

## **3ï¸âƒ£ DAO (UserDao.java)**  
```java
@Mapper
public interface UserDao {
    List<UserDto> searchUsers(@Param("pageSize") int pageSize, @Param("offset") int offset);
    int countTotalUsers();
}
```
ğŸ”¹ `countTotalUsers()` â†’ ì „ì²´ ê°œìˆ˜ë¥¼ êµ¬í•´ì„œ í˜ì´ì§•ì— í™œìš©  

---

## **4ï¸âƒ£ Service (UserService.java)**  
```java
@Service
public class UserService {
    @Autowired
    private UserDao userDao;

    public PageControlDto getUserList(int requestedPage, int pageSize) {
        int totalRecords = userDao.countTotalUsers();
        int totalPages = (int) Math.ceil((double) totalRecords / pageSize);

        int currentPage = Math.max(1, Math.min(requestedPage, totalPages)); // ìµœì†Œ 1, ìµœëŒ€ totalPages ë³´ì¥
        int offset = (currentPage - 1) * pageSize;

        List<UserDto> users = userDao.searchUsers(pageSize, offset);

        // DTO ì„¤ì •
        PageControlDto pageControl = new PageControlDto();
        pageControl.setCurrentPage(currentPage);
        pageControl.setPageSize(pageSize);
        pageControl.setTotalRecords(totalRecords);
        pageControl.setTotalPages(totalPages);
        pageControl.setFirstPageFlag(currentPage == 1);
        pageControl.setLastPageFlag(currentPage == totalPages);

        return pageControl;
    }
}
```
ğŸ”¹ `currentPage`ê°€ 0ì´ë©´ `1`ë¡œ ë³´ì •  
ğŸ”¹ `currentPage`ê°€ `totalPages`ë³´ë‹¤ í¬ë©´ `totalPages`ë¡œ ë³´ì •  

---

## **5ï¸âƒ£ Managed Bean (UserBean.java, JSF ì‚¬ìš©)**  
```java
@ManagedBean
@ViewScoped
public class UserBean {
    @EJB
    private UserService userService;

    private PageControlDto pageControl;
    private List<UserDto> userList;

    private static final int PAGE_SIZE = 10; // í•œ í˜ì´ì§€ë‹¹ 10ê°œ

    @PostConstruct
    public void init() {
        fetchUsers(1); // ì²˜ìŒì—ëŠ” 1í˜ì´ì§€ ë¶ˆëŸ¬ì˜´
    }

    public void fetchUsers(int requestedPage) {
        pageControl = userService.getUserList(requestedPage, PAGE_SIZE);
        userList = pageControl.getUsers();
    }

    // ë²„íŠ¼ ì´ë²¤íŠ¸
    public void moveFirst() { fetchUsers(1); }
    public void movePrevious() { fetchUsers(pageControl.getCurrentPage() - 1); }
    public void moveNext() { fetchUsers(pageControl.getCurrentPage() + 1); }
    public void moveLast() { fetchUsers(pageControl.getTotalPages()); }

    public List<UserDto> getUserList() { return userList; }
    public PageControlDto getPageControl() { return pageControl; }
}
```

---

## **6ï¸âƒ£ JSF XHTML í˜ì´ì§€ (userList.xhtml)**
```xhtml
<h:dataTable value="#{userBean.userList}" var="user">
    <h:column>
        <f:facet name="header">ID</f:facet>
        #{user.id}
    </h:column>
    <h:column>
        <f:facet name="header">ì´ë¦„</f:facet>
        #{user.name}
    </h:column>
    <h:column>
        <f:facet name="header">ì´ë©”ì¼</f:facet>
        #{user.email}
    </h:column>
</h:dataTable>

<!-- í˜ì´ì§• ë²„íŠ¼ -->
<h:commandButton value="â® ë§¨ì•" action="#{userBean.moveFirst}" disabled="#{userBean.pageControl.firstPageFlag}" />
<h:commandButton value="â—€ ì•" action="#{userBean.movePrevious}" disabled="#{userBean.pageControl.firstPageFlag}" />
<h:commandButton value="â–¶ ë’¤" action="#{userBean.moveNext}" disabled="#{userBean.pageControl.lastPageFlag}" />
<h:commandButton value="â­ ë§¨ë’¤" action="#{userBean.moveLast}" disabled="#{userBean.pageControl.lastPageFlag}" />
```
ğŸ”¹ **ì²« í˜ì´ì§€ë©´** "ë§¨ì•ì´ë™", "ì•ì´ë™" ë²„íŠ¼ ë¹„í™œì„±í™” (`disabled`)  
ğŸ”¹ **ë§ˆì§€ë§‰ í˜ì´ì§€ë©´** "ë’¤ì´ë™", "ë§¨ë’¤ì´ë™" ë²„íŠ¼ ë¹„í™œì„±í™” (`disabled`)  

---

# **âœ… ì „ì²´ íë¦„**
1. **í˜ì´ì§€ ìš”ì²­ ì‹œ** `UserBean` â†’ `UserService` í˜¸ì¶œ
2. **`UserService`ì—ì„œ `UserDao` í˜¸ì¶œí•˜ì—¬ ë°ì´í„° ì¡°íšŒ**
3. **í˜ì´ì§• ì²˜ë¦¬ ë° í˜„ì¬ ìƒíƒœ ì €ì¥ (DTO)**
4. **XHTMLì—ì„œ ë²„íŠ¼ í™œì„±/ë¹„í™œì„±í™” ì²˜ë¦¬**

---

# **ğŸ“Œ í•´ê²°ëœ ë¬¸ì œì **
âœ… **"ë§¨ë’¤ì´ë™" ì‹œ `0`ìœ¼ë¡œ ì„¤ì •ë˜ëŠ” ë¬¸ì œ í•´ê²°!**  
âœ… **"ì•ì´ë™"ê³¼ "ë’¤ì´ë™"ì—ì„œ í˜ì´ì§€ ë²”ìœ„ ë³´ì¥!**  
âœ… **SQLì˜ `LIMIT, OFFSET`ì„ ì‚¬ìš©í•˜ì—¬ íš¨ìœ¨ì ì¸ í˜ì´ì§• êµ¬í˜„!**  

---

ì´ì œ `page=0` ë¬¸ì œ ì—†ì´ ì•ˆì „í•˜ê²Œ í˜ì´ì§•ì´ ë™ì‘í•  ê±°ì•¼!  
ì´ì œ ì ìš©í•´ë³´ê³  í•„ìš”í•œ ë¶€ë¶„ ìˆ˜ì •í•´ë„ ì¢‹ì•„!
