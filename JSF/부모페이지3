JSF + MyBatis í™˜ê²½ì—ì„œ **ìì‹ í˜ì´ì§€ì—ì„œ ë¶€ëª¨ í˜ì´ì§€ë¡œ ê°’ ì „ë‹¬ â†’ ë¶€ëª¨ í˜ì´ì§€ì—ì„œ ë¼ë²¨ì— í‘œì‹œ â†’ ë“±ë¡ ë²„íŠ¼ í´ë¦­ ì‹œ `userauth` í…Œì´ë¸” ê²€ì‚¬ í›„ ë“±ë¡ ì²˜ë¦¬**í•˜ëŠ” ì½”ë“œ ì˜ˆì œë¥¼ ì‘ì„±í•´ì¤„ê²Œ.  

---

## **ğŸ”¹ ê¸°ëŠ¥ ìš”ì•½**
1. **ìì‹ í˜ì´ì§€ (`userSelect.xhtml`)**  
   - `input type="radio"`ë¥¼ ì‚¬ìš©í•˜ì—¬ ìœ ì €ë¥¼ ì„ íƒ  
   - ì„ íƒí•œ ìœ ì € ì •ë³´ë¥¼ `window.opener`ë¥¼ í†µí•´ ë¶€ëª¨ í˜ì´ì§€ë¡œ ì „ë‹¬  
   - `window.close()`ë¡œ ìì‹ í˜ì´ì§€ ë‹«ê¸°  

2. **ë¶€ëª¨ í˜ì´ì§€ (`userRegister.xhtml`)**  
   - ì „ë‹¬ë°›ì€ ìœ ì € ì •ë³´ë¥¼ `h:outputText`(ë¼ë²¨)ë¡œ í‘œì‹œ  
   - `ë“±ë¡` ë²„íŠ¼ í´ë¦­ ì‹œ `userauth` í…Œì´ë¸”ì—ì„œ `userid` ì¡´ì¬ ì—¬ë¶€ í™•ì¸ í›„  
     - ì¡´ì¬í•˜ë©´ **ë“±ë¡ ë¶ˆê°€ ë©”ì‹œì§€ í‘œì‹œ**  
     - ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ **DBì— ë“±ë¡**  

---

## **âœ… 1ï¸âƒ£ ìì‹ í˜ì´ì§€ (`userSelect.xhtml`)**
```xhtml
<h:form id="userForm">
    <h:dataTable value="#{userBean.userList}" var="user">
        <h:column>
            <f:facet name="header">ì„ íƒ</f:facet>
            <input type="radio" name="selectedUser" 
                   value="#{user.userid},#{user.username}" 
                   onclick="sendUserInfo(this.value)">
        </h:column>
        <h:column>
            <f:facet name="header">User ID</f:facet>
            #{user.userid}
        </h:column>
        <h:column>
            <f:facet name="header">User Name</f:facet>
            #{user.username}
        </h:column>
    </h:dataTable>
</h:form>

<script>
function sendUserInfo(userInfo) {
    // ë¶€ëª¨ í˜ì´ì§€ì— ê°’ ì „ë‹¬
    if (window.opener && !window.opener.closed) {
        window.opener.receiveUserInfo(userInfo);
    }
    window.close(); // ìì‹ í˜ì´ì§€ ë‹«ê¸°
}
</script>
```
âœ” **ìœ ì €ë¥¼ ì„ íƒí•˜ë©´ `sendUserInfo()`ë¥¼ í†µí•´ ë¶€ëª¨ í˜ì´ì§€ì— ê°’ ì „ë‹¬í•˜ê³  ì°½ ë‹«ìŒ.**  
âœ” `userInfo` ê°’ì€ `"userid,username"` í˜•ì‹ìœ¼ë¡œ ì „ë‹¬ë¨.  

---

## **âœ… 2ï¸âƒ£ ë¶€ëª¨ í˜ì´ì§€ (`userRegister.xhtml`)**
```xhtml
<h:form id="registerForm">
    <h:panelGrid columns="2">
        <h:outputLabel value="ì„ íƒëœ ìœ ì €: " />
        <h:outputText id="selectedUserLabel" value="#{userRegisterBean.selectedUserLabel}" />
    </h:panelGrid>

    <h:commandButton value="ë“±ë¡" action="#{userRegisterBean.registerUser}" />

    <h:messages globalOnly="true" showDetail="true" />
</h:form>

<script>
function receiveUserInfo(userInfo) {
    var userData = userInfo.split(",");
    var userId = userData[0];   // ìœ ì € ID
    var userName = userData[1]; // ìœ ì € ì´ë¦„

    // ë¶€ëª¨ í˜ì´ì§€ì˜ JSF ë¼ë²¨ ì—…ë°ì´íŠ¸
    document.getElementById("registerForm:selectedUserLabel").innerText = userId + " " + userName;

    // JSF Managed Beanì— ê°’ ì „ë‹¬ (Ajax ì—†ì´ hidden field í™œìš©)
    document.getElementById("registerForm:hiddenUserId").value = userId;
    document.getElementById("registerForm:hiddenUserName").value = userName;
}
</script>

<h:inputHidden id="hiddenUserId" value="#{userRegisterBean.selectedUserId}" />
<h:inputHidden id="hiddenUserName" value="#{userRegisterBean.selectedUserName}" />
```
âœ” `receiveUserInfo(userInfo)`ê°€ **ìì‹ í˜ì´ì§€ì—ì„œ ì „ë‹¬ë°›ì€ ìœ ì € ì •ë³´ë¥¼ ë¼ë²¨ì— í‘œì‹œ**  
âœ” `hiddenUserId`ì™€ `hiddenUserName`ì„ í™œìš©í•´ **JSF Beanì— ê°’ ì „ë‹¬**  

---

## **âœ… 3ï¸âƒ£ MyBatis Mapper (`UserAuthMapper.xml`)**
```xml
<mapper namespace="com.example.mapper.UserAuthMapper">
    <!-- ìœ ì €ê°€ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸ -->
    <select id="checkUserExists" parameterType="string" resultType="int">
        SELECT COUNT(*) FROM userauth WHERE userid = #{userid}
    </select>

    <!-- ìœ ì € ë“±ë¡ -->
    <insert id="insertUserAuth" parameterType="com.example.model.UserAuth">
        INSERT INTO userauth (userid, username, created_at)
        VALUES (#{userid}, #{username}, NOW())
    </insert>
</mapper>
```
âœ” `checkUserExists` â†’ `userid`ê°€ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸  
âœ” `insertUserAuth` â†’ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ ìƒˆë¡œìš´ ìœ ì € ë“±ë¡  

---

## **âœ… 4ï¸âƒ£ ë¶€ëª¨ í˜ì´ì§€ì˜ Bean (`UserRegisterBean.java`)**
```java
@ManagedBean
@ViewScoped
public class UserRegisterBean {
    private String selectedUserId;
    private String selectedUserName;

    @Inject
    private UserAuthMapper userAuthMapper; // MyBatis Mapper

    public String getSelectedUserLabel() {
        return selectedUserId != null ? selectedUserId + " " + selectedUserName : "ì„ íƒëœ ìœ ì € ì—†ìŒ";
    }

    public void registerUser() {
        if (selectedUserId == null || selectedUserId.isEmpty()) {
            FacesContext.getCurrentInstance().addMessage(null, new FacesMessage("ìœ ì €ë¥¼ ì„ íƒí•˜ì„¸ìš”."));
            return;
        }

        int exists = userAuthMapper.checkUserExists(selectedUserId);
        if (exists > 0) {
            FacesContext.getCurrentInstance().addMessage(null, new FacesMessage(FacesMessage.SEVERITY_ERROR, "ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ìœ ì €ì…ë‹ˆë‹¤.", null));
        } else {
            UserAuth newUser = new UserAuth(selectedUserId, selectedUserName);
            userAuthMapper.insertUserAuth(newUser);
            FacesContext.getCurrentInstance().addMessage(null, new FacesMessage("ë“±ë¡ ì™„ë£Œ!"));
        }
    }

    // Getter & Setter
    public String getSelectedUserId() { return selectedUserId; }
    public void setSelectedUserId(String selectedUserId) { this.selectedUserId = selectedUserId; }

    public String getSelectedUserName() { return selectedUserName; }
    public void setSelectedUserName(String selectedUserName) { this.selectedUserName = selectedUserName; }
}
```
âœ” `getSelectedUserLabel()` â†’ **ë¼ë²¨ì— "userid username" í˜•íƒœë¡œ í‘œì‹œ**  
âœ” `registerUser()`  
  - `checkUserExists()`ë¡œ ìœ ì €ê°€ ìˆëŠ”ì§€ í™•ì¸  
  - ìˆìœ¼ë©´ **ì—ëŸ¬ ë©”ì‹œì§€ ì¶œë ¥**  
  - ì—†ìœ¼ë©´ **DBì— ë“±ë¡ í›„ ì„±ê³µ ë©”ì‹œì§€ ì¶œë ¥**  

---

## **ğŸ”¥ ìµœì¢… ì •ë¦¬**
âœ… **ìì‹ í˜ì´ì§€**
- ìœ ì € ì„ íƒ í›„ **`window.opener.receiveUserInfo(userInfo)`**ë¡œ ë¶€ëª¨ í˜ì´ì§€ì— ì „ë‹¬  
- ì „ë‹¬ í›„ **ìì‹ í˜ì´ì§€ ë‹«ê¸°**  

âœ… **ë¶€ëª¨ í˜ì´ì§€**
- `receiveUserInfo()`ì—ì„œ **ë¼ë²¨ì— ìœ ì € ì •ë³´ í‘œì‹œ**  
- `ë“±ë¡` ë²„íŠ¼ í´ë¦­ ì‹œ  
  - `userauth` í…Œì´ë¸”ì—ì„œ `userid` ì¡´ì¬ ì—¬ë¶€ í™•ì¸  
  - **ì¡´ì¬í•˜ë©´ ë“±ë¡ ë¶ˆê°€ ë©”ì‹œì§€**, **ì—†ìœ¼ë©´ DBì— ë“±ë¡**  

âœ… **MyBatis**
- `checkUserExists(userid)` â†’ ì¡´ì¬ ì—¬ë¶€ ì²´í¬  
- `insertUserAuth(userid, username)` â†’ ìœ ì € ë“±ë¡  

ì´ì œ ìœ„ ì½”ë“œëŒ€ë¡œ í•˜ë©´ **JSF + MyBatis í™˜ê²½ì—ì„œ ìì‹ í˜ì´ì§€ â†’ ë¶€ëª¨ í˜ì´ì§€ ê°’ ì „ë‹¬ & DB ë“±ë¡ ë¡œì§ì´ ì •ìƒ ì‘ë™í•  ê±°ì•¼!**
